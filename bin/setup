#! /bin/sh

set -eu

version='1.9.0'

binary_dir=$(cd $(dirname $0) && pwd)

if [ -f "$binary_dir/mitamae" ] && [ "$($binary_dir/mitamae version)" = "MItamae v$version" ]; then
  exit
fi

case "$(uname)" in
  "Darwin")
    mitamae_bin="mitamae-x86_64-darwin"
    ;;
  "Linux")
    mitamae_bin="mitamae-x86_64-linux"
    ;;
  *)
    echo "unknown uname: $(uname)"
    exit 1
    ;;
esac

curl -fL -o "${binary_dir}/mitamae" "https://github.com/itamae-kitchen/mitamae/releases/download/v${version}/${mitamae_bin}"
chmod +x "${binary_dir}/mitamae"
