#! /bin/sh

set -eu

version='1.3.1'

binary_dir=$(cd $(dirname $0) && pwd)

case "$(uname)" in
  "Darwin")
    mitamae_bin="mitamae-x86_64-darwin"
    ;;
  "Linux")
    mitamae_bin="mitamae-x86_64-linux"
    ;;
  *)
    echo "unknown uname: $(uname)"
    exit 1
    ;;
esac

mitamae_gz="${mitamae_bin}.tar.gz"

curl -fL "https://github.com/itamae-kitchen/mitamae/releases/download/v${version}/${mitamae_bin}.tar.gz" | tar xvz
mv "${mitamae_bin}" "${binary_dir}/${mitamae_bin}"
chmod +x "${binary_dir}/${mitamae_bin}"
ln -sf "${binary_dir}/${mitamae_bin}" "${binary_dir}/mitamae"
